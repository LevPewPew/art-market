<p id="notice"><%= notice %></p>

<p>
  <strong>Title:</strong>
  <%= @listing.title %>
</p>

<p>
  <strong>Artist:</strong>
  <%= @listing.artist %>
</p>

<p>
  <strong>User:</strong>
  <%= @listing.user.user_detail.name %>
</p>

<p>
  <strong>Price:</strong>
  <%= @listing.price %>
</p>

<%# TODO add listing styles to display %>

<p>
  <strong>Description:</strong>
  <%= @listing.description %>
</p>

<p>
  <strong>Image:</strong>
  <br>
  <%= image_tag @listing.picture, width: "300px" if @listing.picture.attached?%>
</p>

<button data-stripe="payment">Purchase</button>

<%# this script is needed for stripe to work, i don't know exactly how it works, got it from the docs %>
<script src="https://js.stripe.com/v3/"></script>
<script>
  document
    .querySelector("[data-stripe='payment']")
    .addEventListener("click", () => {
      const stripe = Stripe(
        "<%= Rails.application.credentials.dig(:stripe, :public_key) %>"
      );

      stripe.redirectToCheckout({
        sessionId: "<%= @session_id %>"
      });
    });
</script>

<%= link_to 'Back', listings_path %>
